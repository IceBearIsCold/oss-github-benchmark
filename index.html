<!DOCTYPE html>
<html>

<head>
    <title>OSS GitHub Benchmark</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://raw.githack.com/jamesleesaunders/d3-ez/master/dist/d3-ez.js"></script>
    <link rel="stylesheet" type="text/css" href="https://rawgit.com/jamesleesaunders/d3.ez/master/dist/d3-ez.css" />
    <style>
        body, p {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 10px;
        }
    </style>
</head>

<body>
    <div id="chartholder"></div>
    <br />
    <div>Anzahl Repositories: <span id="message"></span></div>

    <script type="text/javascript">
        d3.csv("oss-github-benchmark.csv").then(function (csv) {
            var colors = [d3.rgb(31, 119, 180), d3.rgb(255, 127, 14), d3.rgb(44, 160, 44), d3.rgb(214, 39, 40), d3.rgb(148, 103, 189)];
            var chart = d3.ez.chart.bubbleChart().colors(colors).yAxisLabel("total_num_own_repo_forks");
            var legend = d3.ez.component.legend().title("Sektor");
            var title = d3.ez.component.title().mainText("OSS GitHub Benchmark").subText("9. Februar 2020");

            // Convert csv to d3-ez data format
            // Rename keys
            var tmp = csv.map(function (d) {
                return { "key": d.name, "value": d.num_repos, "x": d.num_members, "y": d.total_num_own_repo_forks, "series": d.sector };
            });
            // Nest Data
            var data = d3.nest().key(function (d) {
                return d.series;
            }).entries(tmp);

            // Create chart base
            var myChart = d3.ez.base()
                .width(750)
                .height(400)
                .chart(chart)
                .legend(legend)
                .title(title)
                .on("customValueMouseOver", function (d) {
                    d3.select("#message").text(d.value);
                })
                .on("customSeriesClick", function (d) {
                    console.log(d);
                });

            d3.select('#chartholder')
                .datum(data)
                .call(myChart);
        });
    </script>
</body>

</html>